{"ast":null,"code":"var _jsxFileName = \"/Volumes/T7 Touch/PHP/API2022/reactapi2022/src/pages/CustomersPageWithPagination.jsx\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport Axios from \"axios\";\nimport Pagination from '../components/Pagination';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst CustomersPageWithPagination = props => {\n  _s();\n\n  const [customers, setCustomers] = useState([]); // pour la pagination \n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalItems, setTotalItems] = useState(0); // définir le nombre d'items par page\n\n  const itemsPerPage = 10;\n\n  const handlePageChange = page => {\n    setCustomers([]);\n    setCurrentPage(page);\n  };\n\n  useEffect(() => {\n    Axios.get(`http://127.0.0.1:8000/api/customers?pagination=true&count=${itemsPerPage}&page=${currentPage}`).then(response => {\n      setCustomers(response.data['hydra:member']);\n      setTotalItems(response.data['hydra:totalItems']);\n    });\n  }, [currentPage]);\n\n  const handleDelete = id => {\n    // pessimiste\n    const originalCustomers = [...customers]; // optimiste\n\n    setCustomers(customers.filter(customer => customer.id !== id));\n    Axios.delete(`http://127.0.0.1:8000/api/customers/${id}`).then(response => console.log('ok')).catch(error => {\n      setCustomers(originalCustomers);\n      console.log(error.response);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Liste des clients\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 14\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      className: \"table table-hover\",\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Id\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Client\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 50,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 51,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Entreprise\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 52,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Factures\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"text-center\",\n            children: \"Montant total\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 54,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"text-center\",\n            children: \"Montant restant\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: [customers.length === 0 && /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: /*#__PURE__*/_jsxDEV(\"td\", {\n            colSpan: \"8\",\n            className: \"text-center\",\n            children: \"Chargement ...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 25\n        }, this), customers.map(customer => /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: customer.id\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: [customer.firstName, \" \", customer.lastName]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: customer.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: customer.company\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"text-center\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"badge badge-primary bg-primary\",\n              children: customer.invoices.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"text-center\",\n            children: [customer.totalAmount.toLocaleString(), \"\\u20AC\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"text-center\",\n            children: [customer.unpaidAmount.toLocaleString(), \"\\u20AC\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              disabled: customer.invoices.length > 0,\n              onClick: () => handleDelete(customer.id),\n              className: \"btn btn-sm btn-danger\",\n              children: \"Supprimer\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 29\n          }, this)]\n        }, customer.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 25\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n      currentPage: currentPage,\n      itemsPerPage: itemsPerPage,\n      length: totalItems,\n      onPageChanged: handlePageChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s(CustomersPageWithPagination, \"hpzySUPS7BBo80d/7Hk9VgiooSQ=\");\n\n_c = CustomersPageWithPagination;\nexport default CustomersPageWithPagination;\n\nvar _c;\n\n$RefreshReg$(_c, \"CustomersPageWithPagination\");","map":{"version":3,"sources":["/Volumes/T7 Touch/PHP/API2022/reactapi2022/src/pages/CustomersPageWithPagination.jsx"],"names":["useState","useEffect","Axios","Pagination","CustomersPageWithPagination","props","customers","setCustomers","currentPage","setCurrentPage","totalItems","setTotalItems","itemsPerPage","handlePageChange","page","get","then","response","data","handleDelete","id","originalCustomers","filter","customer","delete","console","log","catch","error","length","map","firstName","lastName","email","company","invoices","totalAmount","toLocaleString","unpaidAmount"],"mappings":"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","sourcesContent":["import {useState, useEffect} from 'react';\nimport Axios from \"axios\"\nimport Pagination from '../components/Pagination';\n\nconst CustomersPageWithPagination = (props) => {\n    \n    const [customers, setCustomers] = useState([])\n\n    // pour la pagination \n    const [currentPage, setCurrentPage] = useState(1)\n    const [totalItems, setTotalItems] = useState(0)\n    // définir le nombre d'items par page\n    const itemsPerPage = 10\n\n    const handlePageChange = (page) => {\n        setCustomers([])\n        setCurrentPage(page)\n    }\n\n    useEffect(()=>{\n        Axios.get(`http://127.0.0.1:8000/api/customers?pagination=true&count=${itemsPerPage}&page=${currentPage}`)\n            .then(response => {\n                setCustomers(response.data['hydra:member'])\n                setTotalItems(response.data['hydra:totalItems'])\n            })\n    },[currentPage])\n\n    const handleDelete = (id) => {\n        // pessimiste\n        const originalCustomers = [...customers]\n\n        // optimiste\n        setCustomers(customers.filter(customer => customer.id !== id))\n\n        Axios.delete(`http://127.0.0.1:8000/api/customers/${id}`)\n            .then(response => console.log('ok'))\n            .catch(error => {\n                setCustomers(originalCustomers)\n                console.log(error.response)\n            })\n    }\n\n    return ( \n        <>\n             <h1>Liste des clients</h1>\n            <table className='table table-hover'>\n                <thead>\n                    <tr>\n                        <th>Id</th>\n                        <th>Client</th>\n                        <th>Email</th>\n                        <th>Entreprise</th>\n                        <th>Factures</th>\n                        <th className='text-center'>Montant total</th>\n                        <th className='text-center'>Montant restant</th>\n                        <th></th>\n                    </tr>    \n                </thead> \n                <tbody>\n                    {/* ET logique (&&) expr1 && expr2 renvoie expr1 si cette expression peut être convertie en false, sinon renvoie expre 2 */}\n\n                    {customers.length === 0 && (\n                        <tr>\n                            <td colSpan=\"8\" className='text-center'>Chargement ...</td>\n                        </tr>\n                    )}\n\n                    {customers.map(customer => (\n                        <tr key={customer.id}>\n                            <td>{customer.id}</td>\n                            <td>{customer.firstName} {customer.lastName}</td>\n                            <td>{customer.email}</td>\n                            <td>{customer.company}</td>\n                            <td className='text-center'>\n                                <span className=\"badge badge-primary bg-primary\">\n                                    {customer.invoices.length}\n                                </span>\n                            </td>\n                            <td className=\"text-center\">{customer.totalAmount.toLocaleString()}€</td>\n                            <td className=\"text-center\">{customer.unpaidAmount.toLocaleString()}€</td>\n                            <td>\n                                <button\n                                    disabled={customer.invoices.length > 0}\n                                    onClick={()=> handleDelete(customer.id)} \n                                    className=\"btn btn-sm btn-danger\">Supprimer</button>\n                            </td>\n                        </tr>\n                    ))}\n                </tbody>           \n            </table>\n            <Pagination \n                currentPage={currentPage}\n                itemsPerPage={itemsPerPage}\n                length={totalItems}\n                onPageChanged={handlePageChange}\n            />    \n        \n        </>\n\n     );\n}\n \nexport default CustomersPageWithPagination;"]},"metadata":{},"sourceType":"module"}